<!doctype html>
<html lang="en">
    <head>
        <title>Headpat Overlay</title>
        <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <link rel="shortcut icon" href="/favicon.ico" />
        <style>
            @import url("https://fonts.googleapis.com/css2?family=Sniglet&display=swap");

            body {
                color: white;
                background-color: #1e0c35;
                font-family: "Sniglet";
                font-weight: 800;
                font-size: 24px;
            }
            #overlay {
                opacity: 0;
                transform: translateX(-200px);
                transition-duration: 500ms;
                transition-property: opacity, transform;
                transition-timing-function: ease-in-out;
                &.active {
                    opacity: 1;
                    transform: translateX(0);
                }
            }
            .row {
                display: flex;
                flex-direction: row;
                align-items: center;
            }
            .column {
                display: flex;
                flex-direction: column;
                align-items: flex-start;
            }
            .bubble {
                border-radius: 28px;
                height: 56px;
                overflow: hidden;
                margin-bottom: 5px;
                padding-left: 5px;
                padding-right: 15px;
                background-color: rgba(0, 0, 0, 0.25);
            }
            .outlined {
                text-shadow:
                    1px 1px black,
                    1px -1px black,
                    -1px 1px black,
                    -1px -1px black;
                @supports (-moz-appearance: none) {
                    text-shadow: none;
                    filter: drop-shadow(0.4px 0.4px black)
                        drop-shadow(-0.4px 0.4px black)
                        drop-shadow(0.4px -0.4px black)
                        drop-shadow(-0.4px -0.4px black);
                }
            }
            .icon {
                width: 56px;
                height: 56px;
                margin-right: 8px;
                background-repeat: no-repeat;
                background-image: url("data:image/png;base64,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");
            }
            @property --num {
                syntax: "<integer>";
                initial-value: 0;
                inherits: false;
            }
            .counter {
                color: #50b9a2;
                font-size: 32px;
                transition: --num 1s;
                counter-set: num var(--num);
                &::after {
                    content: counter(num);
                }
            }
        </style>
    </head>
    <body>
        <div id="overlay">
            <div class="column">
                <div class="row bubble">
                    <div class="icon"></div>
                    <div class="row outlined">
                        <span id="count" class="counter"></span>&nbsp;
                        <span>headpats redeemed!</span>
                    </div>
                </div>
                <div class="row bubble">
                    <div class="icon"></div>
                    <div class="row outlined">
                        <span id="total" class="counter"></span>&nbsp;
                        <span>total headpats redeemed so far!</span>
                    </div>
                </div>
            </div>
        </div>

        <script>
            const eventUrl = "https://" + window.location.host + "/events";
            const eventSource = new EventSource(eventUrl);

            const overlay = document.getElementById("overlay");
            const countEl = document.getElementById("count");
            const totalEl = document.getElementById("total");

            let mostRecentTimestamp = new Date(0);

            function update(data) {
                const timestamp = new Date(data.timestamp);
                if (timestamp <= mostRecentTimestamp) return;
                mostRecentTimestamp = timestamp;

                const count = parseInt(data.count);
                const total = parseInt(data.total);
                if (isNaN(count) || isNaN(total)) return;

                countEl.style.setProperty("--num", data.count);
                totalEl.style.setProperty("--num", data.total);
            }

            async function getCount() {
                const countUrl = "https://" + window.location.host + "/count";
                const response = await fetch(countUrl);
                data = await response.json();
                update(data);
                overlay.classList.add("active");
            }

            eventSource.onerror = (e) => console.log("ES error", e);
            eventSource.onmessage = (event) => {
                const data = JSON.parse(event.data);
                update(data);
            };
            getCount();
        </script>
    </body>
</html>
